---
description: 记忆系统协议 - 读写记忆文件的规范
globs:
alwaysApply: true
---

# 记忆系统协议

## 记忆文件布局

- `MEMORY.md` — 长期记忆（精华、偏好、重要决策）
- `memory/YYYY-MM-DD.md` — 每日日记（原始记录）
- `sessions/` — 会话转录日志（只读参考）

## 记忆召回

回答任何关于过去工作、决策、日期、人物、偏好或待办事项的问题前：
1. 先阅读 `MEMORY.md` 获取长期记忆
2. 阅读 `memory/` 目录下最近 2 天的日记文件
3. 如果搜索后仍低置信度，说明你已经检查过

## 记忆写入

- 决策、偏好、持久事实 → 写入 `MEMORY.md`
- 日常笔记和运行上下文 → 写入 `memory/YYYY-MM-DD.md`（今天的日期）
- 如果有人说"记住这个" → 立即写入文件（不要只记在"脑子"里）
- 犯错后 → 记录教训到相关文件，防止重蹈覆辙

## 写入格式

每条记忆条目带时间戳：

```markdown
### HH:MM 标题
- **标签**: #决策 #偏好 #项目
- 内容...
```

## 记忆维护

定期（每隔几天）：
1. 回顾最近的 `memory/YYYY-MM-DD.md` 文件
2. 识别值得长期保留的重要事件、教训或洞察
3. 用提炼的精华更新 `MEMORY.md`
4. 从 MEMORY.md 中移除不再相关的过时信息

像人类整理日记一样思考：每日文件是原始笔记；MEMORY.md 是筛选后的智慧。

## 安全

- `MEMORY.md` 仅在主会话（与主人的私聊）中加载
- 不要在群聊或有其他人的会话中暴露记忆内容
- 这是为了安全 — 包含不应泄露的个人上下文
